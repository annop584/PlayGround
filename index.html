<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <title>Test</title>
</head>
<body>
    <div class="garden">
        <div class="ball"></div>
    </div>
    
    <pre class="output"></pre>
    <pre class="shakeoutput"></pre>
    <button onclick='requestOrientationPermission();'>Request orientation permissionzlz</button>
    <script src="shake.js"></script>
    <script>
            var countShake = 0;

            var ball = document.querySelector('.ball');
            var garden = document.querySelector('.garden');
            var output = document.querySelector('.output');
            var shakeoutput = document.querySelector('.shakeoutput');

            var maxX = garden.clientWidth - ball.clientWidth;
            var maxY = garden.clientHeight - ball.clientHeight;
            function requestOrientationPermission() {
                navigator.vibrate(200); // vibrate for 200ms
                    DeviceOrientationEvent.requestPermission()
                        .then(response => {
                            if (response == 'granted') {
                                window.addEventListener('deviceorientation', (e) => {
                                    // do something with e
                                })
                            }
                        })
                        .catch(console.error)
                }
            function handleOrientation(event) {
                var x = event.beta;  // In degree in the range [-180,180)
                var y = event.gamma; // In degree in the range [-90,90)

                output.textContent = `beta : ${x}\n`;
                output.textContent += `gamma: ${y}\n`;

                // Because we don't want to have the device upside down
                // We constrain the x value to the range [-90,90]
                if (x > 90) { x = 90 };
                if (x < -90) { x = -90 };

                // To make computation easier we shift the range of
                // x and y to [0,180]
                x += 90;
                y += 90;

                // 10 is half the size of the ball
                // It center the positioning point to the center of the ball
                ball.style.top = (maxY * y / 180 - 10) + "px";
                ball.style.left = (maxX * x / 180 - 10) + "px";
            }

            // window.addEventListener('deviceorientation', handleOrientation);
                
            // window.addEventListener('devicemotion', function (event) {
            //         console.log(event.acceleration.x + ' m/s2');
            // });



            // var myShakeEvent = new Shake({
            //         threshold: 15, // optional shake strength threshold
            //         timeout: 400 // optional, determines the frequency of event generation
            //     });

            //     myShakeEvent.start();


            //     window.addEventListener('shake', shakeEventDidOccur, false);

            //         //function to call when shake occurs
            //         function shakeEventDidOccur() {

            //             //put your own code here etc.
            //             countShake = countShake+1;
            //             shakeoutput.textContent = `n_shake: ${countShake}\n`;
            //             //alert('shake!');
            //         }
    </script>
</body>
</html>